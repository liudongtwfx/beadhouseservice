<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="zh-CN">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" href="http://127.0.0.1:8088/cssfiles/admin/layout.css" type="text/css" media="screen"/>
    <link rel="stylesheet" href="http://127.0.0.1:8088/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="http://127.0.0.1:8088/cssfiles/premium.css">
    <link rel="stylesheet" href="http://127.0.0.1:8088/cssfiles/fileinput/theme.css">
    <link rel="stylesheet" href="http://127.0.0.1:8088/cssfiles/admin/commonside.css">
    <link rel="stylesheet" href="http://127.0.0.1:8088/cssfiles/font-awesome/css/font-awesome.css">
    <link rel="stylesheet" href="http://127.0.0.1:8088/cssfiles/admin/layout.css" type="text/css" media="screen"/>
    <link rel="stylesheet" href="../bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="../cssfiles/premium.css">
    <link rel="stylesheet" href="../cssfiles/fileinput/theme.css">
    <link rel="stylesheet" href="../cssfiles/admin/commonside.css">
    <link rel="stylesheet" href="../cssfiles/font-awesome/css/font-awesome.css">
    <script src="http://127.0.0.1:8088/jsfiles/jquery-3.1.1.js" type="text/javascript"></script>
    <title>新增数据表</title>
</head>
<body>
<link rel="stylesheet" href="http://127.0.0.1:8088/cssfiles/admin/layout.css" type="text/css" media="screen"/>
<link rel="stylesheet" href="../cssfiles/admin/layout.css" type="text/css" media="screen"/>
<link rel="stylesheet" href="../cssfiles/admin/contentcommon.css" type="text/css" media="screen"/>
<link rel="stylesheet" href="http://127.0.0.1:8088/cssfiles/admin/contentcommon.css" type="text/css" media="screen"/>
<div th:replace="commonside::#secondary_bar"></div>
<div th:replace="commonside::#sidebar"></div>
<div id="main_div">
    <section id="main">
        <div class="header inner_content">
            <h1 class="page-title">养老服务中心后台管理</h1>
            <ul class="breadcrumb">
                <li th:text="#{admin.tables.firsttitle}">养老攻略管理</li>
                <li class="active" th:text="#{admin.tables.list.secondtitle}">添加攻略</li>
            </ul>
        </div>
        <!--/*@thymesVar id="table" type="main.java.com.beadhouse.dynamic.database.databasemetadata.Table"*/-->
        <div class="inner_content real-content">
            <div class="row">
                <div class="text-center" th:classappend="'callback'+${callbackinfo}" th:text="${error}">返回信息
                </div>
            </div>
            <ul th:if="${table} != null and ${#fields.hasErrors('${table}')}" class="errorlist">
                <li th:each="err : ${#fields.errors('*')}" th:text="${err}">输入不合法</li>
            </ul>
            <div class="col-lg-2">
                <span class="">数据库:</span>
                <select id="select_schema">
                    <option th:each="attr:${databases}" th:value="${attr}" th:selected="${schema}"
                            th:text="${attr}"></option>
                </select>
            </div>
            <div th:fragment="tablespart" id="tablepart">
                <div class="col-lg-4">
                    <span class="">数据表:</span>
                    <span th:text="${#lists.size(schemaname)}">-1</span>
                    <select id="tables" onchange="getTableInfo()">
                        <option th:each="attr:${schemaname}" th:value="${attr}" th:selected="${tablename}"
                                th:text="${attr}"></option>
                    </select>
                </div>
            </div>
            <div id="tableinfo">
                <div th:replace="addtable::#addTableForm"></div>
            </div>
        </div>
    </section>
</div>
</body>
<script type="text/javascript">
    $(document).ready(
        function () {
            $("#select_schema").change(
                function () {
                    $.get(
                        "/admin/database/table/list",
                        {
                            schema: $("#select_schema").find("option:selected").text()
                        },
                        function (data) {
                            $("#tablepart").html(data);
                        })
                }
            );
        }
    );

    function getTableInfo() {
        $.get(
            "/admin/database/table/list",
            {
                schema: $("#select_schema").find("option:selected").text(),
                tablename: $("#tables").find("option:selected").text()
            },
            function (data) {
                $("#tableinfo").html(data);
            })
    }
</script>
</html>